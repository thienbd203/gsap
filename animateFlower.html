<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<title>Loader Daisy Soft</title>
<style>
  body {
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
  }

  .flower {
    position:relative;
    width:140px;
    height:140px;
  }

  .petal {
    position:absolute;
    left:50%;
    top:50%;
    /* Wrapper ở đúng tâm; xoay theo vòng */
    transform: translate(-50%,-50%) rotate(var(--r,0deg));
  }

  .blade {
    position:absolute;
    left:50%;
    top:50%;
    width:26px;
    height:70px;
    background:#fff;
    border-radius: 40% 40% 40% 40%;
    /* Gốc cánh đặt tại tâm, phát triển ra ngoài theo trục Y */
    transform: translate(-50%, 0);
    transform-origin:50% 0%;
  }

  .blade::after {
    content:"";
    position:absolute;
    inset:0;
    border-radius:inherit;
    border:1px solid #000; /* viền đen mảnh kiểu logo GD */
  }

  .center {
    position:absolute;
    left:50%;
    top:50%;
    transform:translate(-50%,-50%);
    width:28px;
    height:28px;
    border-radius:50%;
    background:#facc15;
    border:2px solid #000;
    box-shadow:inset 0 2px 4px rgba(0,0,0,0.25);
  }

  /* 8 cánh, xoay quanh */
  .petal:nth-child(1){ --r:0deg; }
  .petal:nth-child(2){ --r:45deg; }
  .petal:nth-child(3){ --r:90deg; }
  .petal:nth-child(4){ --r:135deg; }
  .petal:nth-child(5){ --r:180deg; }
  .petal:nth-child(6){ --r:225deg; }
  .petal:nth-child(7){ --r:270deg; }
  .petal:nth-child(8){ --r:315deg; }

  /* GSAP sẽ điều khiển chuyển động, không dùng keyframes CSS */
</style>
</head>
<body>
  <div class="flower">
    <div class="petal"><div class="blade"></div></div>
    <div class="petal"><div class="blade"></div></div>
    <div class="petal"><div class="blade"></div></div>
    <div class="petal"><div class="blade"></div></div>
    <div class="petal"><div class="blade"></div></div>
    <div class="petal"><div class="blade"></div></div>
    <div class="petal"><div class="blade"></div></div>
    <div class="petal"><div class="blade"></div></div>
    <div class="center"></div>
  </div>
  <!-- GSAP CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script>
    const blades = document.querySelectorAll('.blade');
    // Trạng thái đầu vào rõ ràng để GSAP gộp transform an toàn
    gsap.set(blades, { y: 0, scale: 1, opacity: 1, force3D: true });

    // Đung đưa nhẹ cho mềm mại, xoay quanh gần gốc cánh
    blades.forEach((p, i) => {
      gsap.to(p, {
        rotation: `+=${i % 2 ? 2.5 : -2.5}`,
        transformOrigin: '50% 100%',
        repeat: -1,
        yoyo: true,
        duration: gsap.utils.random(1.8, 2.6),
        ease: 'sine.inOut',
        delay: i * 0.06,
        force3D: true
      });
    });

    function dropThenRegrow() {
      // Rụng tuần tự
      gsap.to(blades, {
        y: 110,
        opacity: 0,
        scale: 0.4,
        duration: 0.9,
        ease: 'power2.in',
        stagger: 0.08,
        overwrite: 'auto',
        force3D: true,
        onComplete: regrow
      });
    }

    function regrow() {
      // Mọc lại từ trong ra
      gsap.fromTo(blades,
        { y: -16, opacity: 0, scale: 0.2, force3D: true },
        { y: 0, opacity: 1, scale: 1, duration: 0.6, ease: 'back.out(1.6)', stagger: 0.07, overwrite: 'auto', force3D: true, onComplete: dropThenRegrow }
      );
    }

    // Bắt đầu vòng lặp
    dropThenRegrow();
  </script>
</body>
</html>
